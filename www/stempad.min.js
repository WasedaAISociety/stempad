Array.prototype.removeAllObject=function(t){for(var e=!1,i=0;i<this.length;i++)this[i]==t&&(this.splice(i,1),e=!0,i--);return e},Array.prototype.removeAnObject=function(t,e){e instanceof Function||(e=function(t,e){return t==e});for(var i=0;i<this.length;i++)if(e(this[i],t))return this.splice(i,1),!0;return!1},Array.prototype.unionWith=function(t,e){for(var i=new Array,r=0,n=t.length;n>r;r++)this.includes(t[r],e)||i.push(t[r]);return this.concat(i)},Array.prototype.includes=function(t,e){if(void 0==e){for(var i=0,r=this.length;r>i;i++)if(this[i]==t)return this[i]}else for(var i=0,r=this.length;r>i;i++)if(e(this[i],t))return this[i];return!1},Array.prototype.getAllMatched=function(t,e){var i=new Array;if(void 0==e)for(var r=0,n=this.length;n>r;r++)this[r]==t&&i.push(this[r]);else for(var r=0,n=this.length;n>r;r++)e(this[r],t)&&i.push(this[r]);return i},Array.prototype.pushUnique=function(t,e){var i=this.includes(t,e);return i?i:(this.push(t),t)},Array.prototype.stableSort=function(t){void 0==t&&(t=function(t,e){return t-e});for(var e=0;e<this.length;e++)this[e].__id__=e;this.sort.call(this,function(e,i){var r=t(e,i);return 0==r?e.__id__>i.__id__?1:-1:r});for(var e=0;e<this.length;e++)delete this[e].__id__},Array.prototype.propertiesNamed=function(t){for(var e=new Array,i=0,r=this.length;r>i;i++)e.push(this[i][t]);return e},String.prototype.replaceAll=function(t,e){return this.split(t).join(e)},String.prototype.splitByArraySeparatorSeparatedLong=function(t){var e=new Array,i=new Array;e[0]=this,i[0]=!1;for(var r=0;r<t.length;r++){for(var n=new Array,o=new Array,s=0;s<e.length;s++)if(i[s])n.push([e[s]]),o.push([!0]);else{var c=e[s].split(t[r]);n[s]=new Array,o[s]=new Array;for(var a=0,d=c.length-1;d>a;a++)""!=c[a]&&(n[s].push(c[a]),o[s].push(!1)),n[s].push(t[r]),o[s].push(!0);""!=c[c.length-1]&&(n[s].push(c[a]),o[s].push(!1))}e=new Array,i=new Array,e=e.concat.apply(e,n),i=i.concat.apply(i,o)}return 0==e.length&&e.push(""),e},String.prototype.escapeForHTML=function(){var t=document.createElement("div");return t.appendChild(document.createTextNode(this)),t.innerHTML};var WordType;!function(t){t[t.NotFound=0]="NotFound",t[t.OnlyInOwn=1]="OnlyInOwn",t[t.OnlyInDocument=2]="OnlyInDocument",t[t.SamePerception=3]="SamePerception",t[t.DifferentPerception=4]="DifferentPerception"}(WordType||(WordType={}));var StempadWord=function(){function t(t,e){this.word=t,this.tooltipHTML=null;var i=e.dictBasedWord.includes(t,function(t,e){return t[1]===e});if(!i)return void(this.type=WordType.NotFound);i=i[1];var r=e.dictA.includes(i,function(t,e){return t[1]===e}),n=e.dictB.includes(i,function(t,e){return t[1]===e});r&&n?(r[0]===n[0]?this.type=WordType.SamePerception:this.type=WordType.DifferentPerception,this.wordIDInOwnDictionary=r[0],this.wordIDInDocumentDictionary=n[0]):r?(this.type=WordType.OnlyInOwn,this.wordIDInOwnDictionary=r[0]):(this.type=WordType.OnlyInDocument,this.wordIDInDocumentDictionary=n[0]),this.tooltipHTML=t.escapeForHTML()}return t}(),Stempad=function(){function t(){this.dictA=new Array,this.dictB=new Array,this.agreementRate=0;var t=this;this.editorDiv=$("#editorbody")[0],this.perceptLevelDiv_same=$("#perceptLevelParent .progress-bar-success")[0],this.perceptLevelDiv_notfound=$("#perceptLevelParent .progress-bar-warning")[0],this.perceptLevelDiv_different=$("#perceptLevelParent .progress-bar-danger")[0],this.perceptLevelDiv_text=$("#perceptLevelParent #perceptLevelText")[0],this.editorDiv.onclick=function(t){t.stopPropagation()},this.setDictionary(),document.body.onclick=function(){$(".highlight-same-perception, .highlight-different-perception, .highlight-only-in-doc").tooltip("hide").each(function(){this.tipStatus=!1,this.preventAutoHide=!1}),t.markupBasedOnDictionary()}}return t.prototype.openWordMenu=function(t){console.log(t),console.log(t.text)},t.prototype.getEditorText=function(){var t="";if(this.editorDiv.hasChildNodes())for(var e=0;e<this.editorDiv.childNodes.length;e++)0!=e&&(t+="\n"),t+=$(this.editorDiv.childNodes[e]).text();else t+=$(this.editorDiv).text();return t},t.prototype.setEditorText=function(t){this.setEditorHTMLText(t.escapeForHTML()),this.markupBasedOnDictionary()},t.prototype.setEditorHTMLText=function(t){this.editorDiv.innerHTML="";for(var e=t.split("\n"),i=0;i<e.length;i++){var r=document.createElement("div");r.innerHTML=e[i],this.editorDiv.appendChild(r)}},t.prototype.setDictionary=function(t,e){this.dictA=t?t:this.dictA,this.dictB=e?e:this.dictB,this.dictBasedID=this.dictA.unionWith(this.dictB,function(t,e){return t[0]===e[0]}),this.dictBasedWord=this.dictA.unionWith(this.dictB,function(t,e){return t[1]===e[1]}),this.wordListInDict=this.dictBasedWord.propertiesNamed(1),this.wordListInDict.stableSort(function(t,e){return t.length-e.length}),this.showDictionary()},t.prototype.showDictionary=function(){for(var t=document.getElementById("dict"),e="",i=function(t,i){e+='<div class="col-lg-6 col-md-6 col-sm-6 col-xs-6 '+i+'"><dl>',e+="<dt>"+t[1].escapeForHTML()+"</dt>",e+="<dd>"+t[2].escapeForHTML()+"</dd>",e+="</dl></div>"},r=0;r<this.dictBasedWord.length;r++){e+='<div class="row heightLineParent">';var n=this.dictBasedWord[r][1],o=this.dictBasedID.getAllMatched(n,function(t,e){return t[1]===e});if(1==o.length){var s=this.dictA.includes(n,function(t,e){return t[1]===e}),c=this.dictB.includes(n,function(t,e){return t[1]===e});s&&c?(e+='<div class="col-lg-3 col-md-3 col-sm-3 col-xs-3"></div>',i(s,"dict-common")):s?i(s,"dict-own"):(e+='<div class="col-lg-6 col-md-6 col-sm-6 col-xs-6"></div>',i(c,"dict-only-in-doc"))}else{var a=this.dictA.includes(n,function(t,e){return t[1]===e});i(a,"dict-own");var a=this.dictB.includes(n,function(t,e){return t[1]===e});i(a,"dict-doc")}e+="</div>"}t.innerHTML=e;for(var d=$(".heightLineParent"),r=0;r<d.length;r++)$(d[r].childNodes).heightLine()},t.prototype.markupBasedOnDictionary=function(){for(var t=this.getEditorText(),e=t.splitByArraySeparatorSeparatedLong(this.wordListInDict),i=0,r=0,n=0,o=0;o<e.length;o++){var s=new StempadWord(e[o],this);s.type==WordType.SamePerception?(e[o]='<span class="highlight-same-perception w'+UUID.convertFromBase64String(s.wordIDInDocumentDictionary)+'">'+e[o].escapeForHTML()+"</span>",i++,r++):s.type==WordType.DifferentPerception?(e[o]='<span class="highlight-different-perception w'+UUID.convertFromBase64String(s.wordIDInDocumentDictionary)+'">'+e[o].escapeForHTML()+"</span>",i++):s.type==WordType.OnlyInDocument?(e[o]='<span class="highlight-only-in-doc w'+UUID.convertFromBase64String(s.wordIDInDocumentDictionary)+'">'+e[o].escapeForHTML()+"</span>",i++,n++):e[o]=e[o].escapeForHTML()}this.agreementRate=r/i*100,this.perceptLevelDiv_same.style.width=r/i*100+"%",this.perceptLevelDiv_notfound.style.width=n/i*100+"%",this.perceptLevelDiv_different.style.width=100-(r+n)/i*100+"%",this.perceptLevelDiv_text.innerHTML="一致度: "+this.agreementRate.toFixed(2)+"%",t=e.join(""),this.setEditorHTMLText(t);for(var o=0;o<this.dictBasedID.length;o++){var c,a=".w"+UUID.convertFromBase64String(this.dictBasedID[o][0]),s=new StempadWord(this.dictBasedID[o][1],this);if(s.type==WordType.SamePerception)c='<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner highlightip-same-perception"></div></div>';else if(s.type==WordType.DifferentPerception)c='<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner highlightip-different-perception"></div></div>';else{if(s.type!=WordType.OnlyInDocument)continue;c='<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner highlightip-only-in-doc"></div></div>'}var d="<h4>"+this.dictBasedID[o][1]+"</h4><pre>ID: "+this.dictBasedID[o][0]+"</pre><p>"+this.dictBasedID[o][2]+"</p>";$(a).tooltip({title:d,placement:"bottom",html:!0,template:c,trigger:"manual",container:"body"}).on("mouseenter",function(){this.tipStatus||($(this).tooltip("show"),this.tipStatus=!0)}).on("mouseleave",function(){!this.preventAutoHide&&this.tipStatus&&($(this).tooltip("hide"),this.tipStatus=!1)}).on("click",function(){this.preventAutoHide=!this.preventAutoHide,event.stopPropagation()})}},t}();$(function(){$("#editorbody").tooltip({selector:"a[rel=tooltip]"});var t=new Stempad;t.setDictionary([["LMD3UwP5Twms9hnW3yUHAQ","集合","ある特定のはっきり識別できる条件に合うものを一まとめにして考えた、全体。"],["67SNKR52QYqtrZH57SqMNA","概念","事象に対して、抽象化・ 普遍化してとらえた、思考の基礎となる基本的な形態として、脳の機能によってとらえたもの。"],["mp2ZnRn/T9WSrVixhzGVdA","数学","数および図形についての学問"]],[["k8sxescVRqK8YY+DsB3B8Q","集合","一か所に集まる、または集めること。"],["67SNKR52QYqtrZH57SqMNA","概念","事象に対して、抽象化・ 普遍化してとらえた、思考の基礎となる基本的な形態として、脳の機能によってとらえたもの。"],["mp2ZnRn/T9WSrVixhzGVdA","数学","数および図形についての学問"],["UoXrwSmhSgqXwEAQIjvo+g","写像","二つの集合が与えられたときに、一方の集合の各元に対し、他方の集合のただひとつの元からなる集合を指定して結びつける対応のことである。"]]),t.setEditorText("集合は、集合論のみならず現代数学全体における最も基本的な概念の一つであり、現代数学のほとんどが集合と写像の言葉で書かれていると言ってよい。")});var UUID=function(){function t(){}return t.verifyUUID=function(t){return t&&36==t.length?t.toLowerCase():!1},t.convertFromHexString=function(t){return 32!=t.length?!1:this.verifyUUID(t.substr(0,8)+"-"+t.substr(8,4)+"-"+t.substr(12,4)+"-"+t.substr(16,4)+"-"+t.substr(20,12))},t.convertFromBase64String=function(e){var i,r="",n=0;for(22===e.length&&(e+="=="),i=0;i<e.length;i++){var o=e.charCodeAt(i);if(n<<=6,o>=65&&90>=o)n|=o-65;else if(o>=97&&122>=o)n|=o-97+26;else if(o>=48&&57>=o)n|=o-48+52;else if(43===o)n|=62;else if(47===o)n|=63;else if(61!==o)throw"Invalid Base64 String.";3===(3&i)&&(r+=n.toString(16),n=0)}return r=r.substr(0,32),t.convertFromHexString(r)},t.generateVersion4=function(){var t=this.generate16bitHexStrFromNumber,e=this.generateRandom16bitHexStr,i=this.generateRandom16bitHex;return e()+e()+"-"+e()+"-"+t(16384|4095&i())+"-"+t(32768|16383&i())+"-"+e()+e()+e()},t.generateRandom16bitHexStr=function(){return(65536*(1+Math.random())|0).toString(16).toLowerCase().substring(1)},t.generateRandom16bitHex=function(){return 65536*Math.random()|0},t.generate16bitHexStrFromNumber=function(t){return(t+65536).toString(16).toLowerCase().substring(1)},t.getBase64EncodedUUID=function(t){if(t=this.verifyUUID(t),!t)return null;t=t.replaceAll("-","")+"0000";for(var e="",i=function(t){return t>=0&&26>t?String.fromCharCode(65+t):t>=26&&52>t?String.fromCharCode(97+(t-26)):t>=52&&62>t?String.fromCharCode(48+(t-52)):t>=62&&64>t?62==t?"+":"/":void 0},r=0;6>r;r++){var n=parseInt(t.substr(6*r,6),16);e+=i(63&n>>18),e+=i(63&n>>12),e+=i(63&n>>6),e+=i(63&n)}return e=e.substr(0,22)+"=="},t.nullUUID="00000000-0000-0000-0000-000000000000",t}();