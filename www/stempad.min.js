Array.prototype.removeAllObject=function(t){for(var e=!1,r=0;r<this.length;r++)this[r]==t&&(this.splice(r,1),e=!0,r--);return e},Array.prototype.removeAnObject=function(t,e){e instanceof Function||(e=function(t,e){return t==e});for(var r=0;r<this.length;r++)if(e(this[r],t))return this.splice(r,1),!0;return!1},Array.prototype.unionWith=function(t,e){for(var r=new Array,n=0,i=t.length;i>n;n++)this.includes(t[n],e)||r.push(t[n]);return this.concat(r)},Array.prototype.includes=function(t,e){if(void 0==e){for(var r=0,n=this.length;n>r;r++)if(this[r]==t)return this[r]}else for(var r=0,n=this.length;n>r;r++)if(e(this[r],t))return this[r];return!1},Array.prototype.getAllMatched=function(t,e){var r=new Array;if(void 0==e)for(var n=0,i=this.length;i>n;n++)this[n]==t&&r.push(this[n]);else for(var n=0,i=this.length;i>n;n++)e(this[n],t)&&r.push(this[n]);return r},Array.prototype.pushUnique=function(t,e){var r=this.includes(t,e);return r?r:(this.push(t),t)},Array.prototype.stableSort=function(t){void 0==t&&(t=function(t,e){return t-e});for(var e=0;e<this.length;e++)this[e].__id__=e;this.sort.call(this,function(e,r){var n=t(e,r);return 0==n?e.__id__>r.__id__?1:-1:n});for(var e=0;e<this.length;e++)delete this[e].__id__},Array.prototype.propertiesNamed=function(t){for(var e=new Array,r=0,n=this.length;n>r;r++)e.push(this[r][t]);return e},String.prototype.replaceAll=function(t,e){return this.split(t).join(e)},String.prototype.splitByArraySeparatorSeparatedLong=function(t){var e=new Array,r=new Array;e[0]=this,r[0]=!1;for(var n=0;n<t.length;n++){for(var i=new Array,o=new Array,s=0;s<e.length;s++)if(r[s])i.push([e[s]]),o.push([!0]);else{var c=e[s].split(t[n]);i[s]=new Array,o[s]=new Array;for(var a=0,d=c.length-1;d>a;a++)""!=c[a]&&(i[s].push(c[a]),o[s].push(!1)),i[s].push(t[n]),o[s].push(!0);""!=c[c.length-1]&&(i[s].push(c[a]),o[s].push(!1))}e=new Array,r=new Array,e=e.concat.apply(e,i),r=r.concat.apply(r,o)}return 0==e.length&&e.push(""),e},String.prototype.escapeForHTML=function(){var t=document.createElement("div");return t.appendChild(document.createTextNode(this)),t.innerHTML};var WordType;!function(t){t[t.NotFound=0]="NotFound",t[t.OnlyInOwn=1]="OnlyInOwn",t[t.OnlyInDocument=2]="OnlyInDocument",t[t.SamePerception=3]="SamePerception",t[t.DifferentPerception=4]="DifferentPerception"}(WordType||(WordType={}));var Stempad=function(){function t(t,e,r){this.dictA=new Array,this.dictB=new Array,this.agreementRate=0;var n=this;this.editorDiv=t,this.perceptLevelDiv=e,this.perceptLevelTextDiv=r,this.editorDiv.onclick=function(t){t.stopPropagation()},this.setDictionary(),document.body.onclick=function(){n.markupBasedOnDictionary()}}return t.prototype.openWordMenu=function(t){console.log(t),console.log(t.text)},t.prototype.getEditorText=function(){var t="";if(this.editorDiv.hasChildNodes())for(var e=0;e<this.editorDiv.childNodes.length;e++)0!=e&&(t+="\n"),t+=$(this.editorDiv.childNodes[e]).text();else t+=$(this.editorDiv).text();return t},t.prototype.setEditorText=function(t){this.setEditorHTMLText(t.escapeForHTML()),this.markupBasedOnDictionary()},t.prototype.setEditorHTMLText=function(t){this.editorDiv.innerHTML="";for(var e=t.split("\n"),r=0;r<e.length;r++){var n=document.createElement("div");n.innerHTML=e[r],this.editorDiv.appendChild(n)}},t.prototype.setDictionary=function(t,e){this.dictA=t?t:this.dictA,this.dictB=e?e:this.dictB,this.dictBasedID=this.dictA.unionWith(this.dictB,function(t,e){return t[0]===e[0]}),this.dictBasedWord=this.dictA.unionWith(this.dictB,function(t,e){return t[1]===e[1]}),this.wordListInDict=this.dictBasedWord.propertiesNamed(1),this.wordListInDict.stableSort(function(t,e){return t.length-e.length}),this.showDictionary()},t.prototype.showDictionary=function(){for(var t=document.getElementById("dict"),e="",r=function(t,r){e+='<div class="col-lg-6 col-md-6 col-sm-6 col-xs-6 '+r+'"><dl>',e+="<dt>"+t[1].escapeForHTML()+"</dt>",e+="<dd>"+t[2].escapeForHTML()+"</dd>",e+="</dl></div>"},n=0;n<this.dictBasedWord.length;n++){e+='<div class="row heightLineParent">';var i=this.dictBasedWord[n][1],o=this.dictBasedID.getAllMatched(i,function(t,e){return t[1]===e});if(1==o.length){var s=this.dictA.includes(i,function(t,e){return t[1]===e}),c=this.dictB.includes(i,function(t,e){return t[1]===e});s&&c?(e+='<div class="col-lg-3 col-md-3 col-sm-3 col-xs-3"></div>',r(s,"dictCommon")):s?r(s,"dictA"):(e+='<div class="col-lg-6 col-md-6 col-sm-6 col-xs-6"></div>',r(c,"dictB"))}else{var a=this.dictA.includes(i,function(t,e){return t[1]===e});r(a,"dictA");var a=this.dictB.includes(i,function(t,e){return t[1]===e});r(a,"dictB")}e+="</div>"}t.innerHTML=e,$(".heightLineParent>div").heightLine()},t.prototype.getWordType=function(t){var e=this.dictBasedWord.includes(t,function(t,e){return t[1]===e});if(!e)return WordType.NotFound;e=e[1];var r=this.dictA.includes(e,function(t,e){return t[1]===e}),n=this.dictB.includes(e,function(t,e){return t[1]===e});return r&&n?r[0]===n[0]?WordType.SamePerception:WordType.DifferentPerception:r?WordType.OnlyInOwn:WordType.OnlyInDocument},t.prototype.markupBasedOnDictionary=function(){for(var t=this.getEditorText(),e=t.splitByArraySeparatorSeparatedLong(this.wordListInDict),r=0,n=0,i=0;i<e.length;i++){var o=this.getWordType(e[i]);o==WordType.SamePerception?(e[i]='<span style="background-color: #c0ffee">'+e[i].escapeForHTML()+"</span>",r++,n++):o==WordType.DifferentPerception?(e[i]='<span style="background-color: #ffc0ee">'+e[i].escapeForHTML()+"</span>",r++):e[i]=e[i].escapeForHTML()}this.agreementRate=n/r*100,this.perceptLevelDiv.style.width=this.agreementRate+"%",this.perceptLevelTextDiv.innerHTML="一致度: "+this.agreementRate.toFixed(2)+"%",t=e.join(""),this.setEditorHTMLText(t)},t}();$(function(){var t=new Stempad(document.getElementById("editorbody"),document.getElementById("perceptLevel"),document.getElementById("perceptLevelText"));t.setDictionary([["LMD3UwP5Twms9hnW3yUHAQ","集合","ある特定のはっきり識別できる条件に合うものを一まとめにして考えた、全体。"],["67SNKR52QYqtrZH57SqMNA","概念","事象に対して、抽象化・ 普遍化してとらえた、思考の基礎となる基本的な形態として、脳の機能によってとらえたもの。"],["mp2ZnRn/T9WSrVixhzGVdA","数学","数および図形についての学問"]],[["k8sxescVRqK8YY+DsB3B8Q","集合","一か所に集まる、または集めること。"],["67SNKR52QYqtrZH57SqMNA","概念","事象に対して、抽象化・ 普遍化してとらえた、思考の基礎となる基本的な形態として、脳の機能によってとらえたもの。"],["mp2ZnRn/T9WSrVixhzGVdA","数学","数および図形についての学問"]]),t.setEditorText("集合は、集合論のみならず現代数学全体における最も基本的な概念の一つであり、現代数学のほとんどが集合と写像の言葉で書かれていると言ってよい。")});var UUID=function(){function t(){}return t.verifyUUID=function(t){return t&&36==t.length?t.toLowerCase():!1},t.convertFromHexString=function(t){return 32!=t.length?!1:this.verifyUUID(t.substr(0,8)+"-"+t.substr(8,4)+"-"+t.substr(12,4)+"-"+t.substr(16,4)+"-"+t.substr(20,12))},t.generateVersion4=function(){var t=this.generate16bitHexStrFromNumber,e=this.generateRandom16bitHexStr,r=this.generateRandom16bitHex;return e()+e()+"-"+e()+"-"+t(16384|4095&r())+"-"+t(32768|16383&r())+"-"+e()+e()+e()},t.generateRandom16bitHexStr=function(){return(65536*(1+Math.random())|0).toString(16).toLowerCase().substring(1)},t.generateRandom16bitHex=function(){return 65536*Math.random()|0},t.generate16bitHexStrFromNumber=function(t){return(t+65536).toString(16).toLowerCase().substring(1)},t.getBase64EncodedUUID=function(t){if(t=this.verifyUUID(t),!t)return null;t=t.replaceAll("-","")+"0000";for(var e="",r=function(t){return t>=0&&26>t?String.fromCharCode(65+t):t>=26&&52>t?String.fromCharCode(97+(t-26)):t>=52&&62>t?String.fromCharCode(48+(t-52)):t>=62&&64>t?62==t?"+":"/":void 0},n=0;6>n;n++){var i=parseInt(t.substr(6*n,6),16);e+=r(63&i>>18),e+=r(63&i>>12),e+=r(63&i>>6),e+=r(63&i)}return e=e.substr(0,22)+"=="},t.nullUUID="00000000-0000-0000-0000-000000000000",t}();